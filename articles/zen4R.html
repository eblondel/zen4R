<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>zen4R User Manual • zen4R</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="zen4R User Manual">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zen4R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/zen4R.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/eblondel/zen4R/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>zen4R User Manual</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/eblondel/zen4R/blob/master/vignettes/zen4R.Rmd" class="external-link"><code>vignettes/zen4R.Rmd</code></a></small>
      <div class="hidden name"><code>zen4R.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="zen4r---r-interface-to-zenodo-rest-api">zen4R - R Interface to Zenodo REST API<a class="anchor" aria-label="anchor" href="#zen4r---r-interface-to-zenodo-rest-api"></a>
</h2>
<p><a href="https://doi.org/10.5281/zenodo.2547036" class="external-link"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.2547036.svg" alt="DOI"></a></p>
<p>Provides an Interface to <a href="https://zenodo.org" class="external-link">Zenodo</a> REST
API, including management of depositions, attribution of DOIs by
‘Zenodo’ and upload of files.</p>
<hr>
<p>For zen4R sponsoring/funding new developments, enhancements, support
requests, please contact me by <a href="mailto:eblondel.pro@gmail.com">e-mail</a></p>
<p>Many thanks to the following organizations that have provided
fundings for strenghtening the <code>zen4R</code> package:</p>
<div style="float:left;">
<p><a href="https://en.ird.fr/" class="external-link"><img src="https://en.ird.fr/sites/ird_fr/files/2019-08/logo_IRD_2016_BLOC_UK_COUL.png" height="200" width="200/"></a>
<a href="https://www.fao.org/home/en/" class="external-link"><img height="200" width="200" src="https://www.fao.org/fileadmin/templates/family-farming-decade/images/FAO-IFAD-Logos/FAO-Logo-EN.svg"></a></p>
</div>
<p>The following projects have contributed to strenghten
<code>zen4R</code>:</p>
<ul>
<li>
<a href="https://blue-cloud.org/" class="external-link">Blue-Cloud</a>: <em>Blue-Cloud has
received funding from the European Union’s Horizon programme call
BG-07-2019-2020, topic: [A] 2019 - Blue Cloud services, Grant Agreement
No.862409.</em>
</li>
</ul>
<hr>
<p><strong>Table of contents</strong></p>
<p><a href="#package_overview"><strong>1. Overview</strong></a><br><a href="#package_status"><strong>2. Package status</strong></a><br><a href="#package_credits"><strong>3. Credits</strong></a><br><a href="#user_guide"><strong>4. User guide</strong></a><br>    <a href="#install_guide">4.1 Installation</a><br>    <a href="#ZenodoManager">4.2 Connect to Zenodo REST API</a><br>    <a href="#ZenodoDeposit-query">4.3 Query Zenodo deposited records</a><br>
      <a href="#ZenodoDeposit-getdepositions">4.3.1 Get
Depositions</a><br>       <a href="#ZenodoDeposit-getdepositionbyconceptdoi">4.3.2 Get Deposition By
Concept DOI</a><br>       <a href="#ZenodoDeposit-getdepositionbydoi">4.3.3 Get Deposition By
DOI</a><br>       <a href="#ZenodoDeposit-getdepositionbyid">4.3.4 Get
Deposition By Zenodo record ID</a><br>       <a href="#ZenodoDeposit-getversions">4.3.5 Get Deposition versions</a><br>
   <a href="#ZenodoDeposit">4.4 Manage Zenodo record
depositions</a><br>       <a href="#ZenodoDeposit-emptyRecord">4.4.1
Create an empty record</a><br>       <a href="#ZenodoDeposit-fill">4.4.2 Fill a record</a><br>       <a href="#ZenodoDeposit-deposit">4.4.3 Deposit/Update a record</a><br>
      <a href="#ZenodoDeposit-delete">4.4.4 Delete a record</a><br>
      <a href="#ZenodoDeposit-publish">4.4.5 Publish a record</a><br>
      <a href="#ZenodoDeposit-edit">4.4.6 Edit/Update a published
record</a><br>       <a href="#ZenodoDeposit-discard">4.4.7 Discard
changes of a draft record</a><br>       <a href="#ZenodoDeposit-version">4.4.8 Create a new record version</a><br>
   <a href="#ZenodoDepositFile">4.5 Manage Zenodo record deposition
files</a><br>       <a href="#ZenodoDepositFile-upload">4.5.1 Upload
file</a><br>       <a href="#ZenodoDepositFile-get">4.5.2 Get
files</a><br>       <a href="#ZenodoDepositFile-delete">4.5.3 Delete
file</a><br>    <a href="#ZenodoDeposit-communities">4.6 Manage Zenodo
record communities</a><br>       <a href="#ZenodoDeposit-communities-published">4.6.1 Submit a published
record to communities</a><br>       <a href="#ZenodoDeposit-communities-draft">4.6.2 Submit a draft record to a
community</a><br>    <a href="#ZenodoDepositMetadata">4.7 Export Zenodo
record metadata</a><br>       <a href="#ZenodoDepositMetadata-byformat">4.7.1 Export Zenodo record
metadata by format</a><br>       <a href="#ZenodoDepositMetadata-allformats">4.7.2 Export Zenodo record
metadata - all formats</a><br>    <a href="#ZenodoVocabularies">4.8
Browse Zenodo controlled vocabularies</a><br>       <a href="#ZenodoVocabularies-communities">4.8.1 Communities</a><br>
      <a href="#ZenodoVocabularies-licenses">4.8.2 Licenses</a><br>
      <a href="#ZenodoVocabularies-funders">4.8.3 Funders</a><br>
      <a href="#ZenodoVocabularies-grants">4.8.4 Grants</a><br>    <a href="#ZenodoRecord-query">4.9 Query Zenodo published records</a><br>
      <a href="#ZenodoRecord-getrecords">4.9.1 Get Records</a><br>
      <a href="#ZenodoRecord-getrecordbyconceptdoi">4.9.2 Get Record By
Concept DOI</a><br>       <a href="#ZenodoRecord-getrecordbydoi">4.9.3
Get Record By DOI</a><br>       <a href="#ZenodoRecord-getrecordbyid">4.9.4 Get Record By ID</a><br>    <a href="#ZenodoRecord-download">4.10 Download files from Zenodo
records</a><br>    <a href="#Zenodo-requests">4.11 Manage
requests</a><br><a href="#package_issues"><strong>5. Issue
reporting</strong></a><br><a href="#user_support"><strong>6. User
support</strong></a><br></p>
<p><a name="package_overview"></a></p>
<div class="section level4">
<h4 id="overview-and-vision">1. Overview and vision<a class="anchor" aria-label="anchor" href="#overview-and-vision"></a>
</h4>
<hr>
<p>The <a href="https://doi.org/10.5281/zenodo.2547036" class="external-link">zen4R</a>
package offers an R interface to the <a href="https://zenodo.org" class="external-link">Zenodo</a> e-infrastructure. It supports most
of the Zenodo features including the management of metadata records
(including versioning), upload/download of files, and assignment of
Digital Object Identifier(s) (DOIs), statistics, community
management.</p>
<p><a href="https://doi.org/10.5281/zenodo.2547036" class="external-link">zen4R</a> is jointly
developed together with the <a href="https://github.com/r-geoflow/geoflow" class="external-link">geoflow</a> which intends to
facilitate and automate the production of geographic metadata documents
and their associated datasources, where <a href="https://doi.org/10.5281/zenodo.2547036" class="external-link">zen4R</a> is used to
assign DOIs and cross-reference these DOIs in other metadata documents
such as geographic metadata (ISO 19115/19139) hosted in metadata
catalogues and open data portals.</p>
<p><a name="package_status"></a></p>
</div>
<div class="section level4">
<h4 id="development-status">2. Development status<a class="anchor" aria-label="anchor" href="#development-status"></a>
</h4>
<hr>
<ul>
<li>January 2019: Inception. Code source managed on GitHub</li>
<li>June 2019: 1st publication on CRAN</li>
<li>Oct 2023/June 2024: upgrade to follow the move of Zenodo to Invenio
RDM</li>
</ul>
<p><a name="package_credits"></a></p>
</div>
<div class="section level4">
<h4 id="credits">3. Credits<a class="anchor" aria-label="anchor" href="#credits"></a>
</h4>
<hr>
<ol start="3" style="list-style-type: lower-alpha">
<li>2019, Emmanuel Blondel</li>
</ol>
<p>Package distributed under MIT license.</p>
<p>If you use <code>zen4R</code>, I would be very grateful if you can
add a citation in your published work. By citing <code>zen4R</code>,
beyond acknowledging the work, you contribute to make it more visible
and guarantee its growing and sustainability. For citation, please use
the DOI: <a href="https://doi.org/10.5281/zenodo.2547036" class="external-link"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.2547036.svg" alt="DOI"></a></p>
<p><a name="user_guide"></a></p>
</div>
<div class="section level4">
<h4 id="user-guide">4. User guide<a class="anchor" aria-label="anchor" href="#user-guide"></a>
</h4>
<hr>
<p><a name="install_guide"></a></p>
<div class="section level5">
<h5 id="how-to-install-zen4r-in-r">4.1 How to install zen4R in R<a class="anchor" aria-label="anchor" href="#how-to-install-zen4r-in-r"></a>
</h5>
<p>For now, the package can be installed from Github</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span></span></code></pre></div>
<p>Once the remotes package loaded, you can use the install_github to
install <code>zen4R</code>. By default, package will be installed from
<code>master</code> which is the current version in development (likely
to be unstable).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://remotes.r-lib.org" class="external-link">"remotes"</a></span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"eblondel/zen4R"</span><span class="op">)</span></span></code></pre></div>
<p>For Linux/OSX, make sure to install the <code>sodium</code> package
as follows:</p>
<pre><code>sudo apt-get install -y libsodium-dev</code></pre>
<p><a name="ZenodoManager"></a></p>
</div>
<div class="section level5">
<h5 id="connect-to-zenodo-rest-api">4.2 Connect to Zenodo REST API<a class="anchor" aria-label="anchor" href="#connect-to-zenodo-rest-api"></a>
</h5>
<p>The main entry point of <code>zen4R</code> is the
<code>ZenodoManager</code>. Some basic methods, such as listing licenses
known by Zenodo, do not require the token.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zenodo</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ZenodoManager.html">ZenodoManager</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>To use deposit functions of <code>zen4R</code>, you will need to
specify the <code>token</code>. This token can be created <a href="https://zenodo.org/account/settings/applications/tokens/new/" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>zenodo <span class="ot">&lt;-</span> ZenodoManager<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>   <span class="at">token =</span> <span class="sc">&lt;</span>your_token<span class="sc">&gt;</span>, </span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>   <span class="at">logger =</span> <span class="st">"INFO"</span> <span class="co"># use "DEBUG" to see detailed API operation logs, use NULL if you don't want logs at all</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>)</span></code></pre></div>
<p>By default, the <code>zen4R</code> <strong>logger</strong> is
deactivated. To enable the logger, specify the level of log you wish as
parameter of the above R code. Two logging levels are available:</p>
<ul>
<li>
<code>INFO</code>: will print the <code>zen4R</code> logs. Three
types of messages can be distinguished: <code>INFO</code>,
<code>WARN</code>, <code>ERROR</code>. The latter is generally
associated with a <code>stop</code> and indicate an blocking error for
the R method executed.</li>
<li>
<code>DEBUG</code> will print the above <code>zen4R</code> logs, and
report all logs from HTTP requests performed with <code>cURL</code>
</li>
</ul>
<p>If you want to use the <a href="https://sandbox.zenodo.org" class="external-link">Zenodo
sandbox</a> to test record management before going with the production
Zenodo e-infrastructure, you can specify <code>sandbox = TRUE</code> in
the <code>ZenodoManager</code>.</p>
<p><strong>Important: To use the Zenodo sandbox, you need to set up a
sandbox account separately from Zenodo, create a separate personal
access token to the sandbox API, and you must confirm via the
confirmation link this account separately in order to be able to test
your record management on this clone of Zenodo.</strong></p>
<p>The below code instructs how to connect to the Sandbox Zenodo
e-infrastructure:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>zenodo <span class="ot">&lt;-</span> ZenodoManager<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>   <span class="at">token =</span> <span class="sc">&lt;</span>your_zenodo_sandbox_token<span class="sc">&gt;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>   <span class="at">sandbox =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>   <span class="at">logger =</span> <span class="st">"INFO"</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>)</span></code></pre></div>
<p><a name="ZenodoDeposit-query"></a></p>
</div>
<div class="section level5">
<h5 id="query-zenodo-deposited-records">4.3 Query Zenodo deposited records<a class="anchor" aria-label="anchor" href="#query-zenodo-deposited-records"></a>
</h5>
<p><a href="https://doi.org/10.5281/zenodo.2547036" class="external-link">zen4R</a> offers
several methods to query Zenodo depositions.</p>
<p><a name="ZenodoDeposit-query-getdepositions"></a></p>
<div class="section level6">
<h6 id="get-depositions">4.3.1 Get Depositions<a class="anchor" aria-label="anchor" href="#get-depositions"></a>
</h6>
<p>The generic way to query depositions is to use the method
<code>getDepositions</code>. If specified with no parameter, all
depositions will be returned:</p>
<pre><code><span><span class="va">my_zenodo_records</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getDepositions</span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>It is also possible to specify an ElasticSearch query using the
<code>q</code> parameter. For helpers and query examples, please consult
this <a href="https://help.zenodo.org/guides/search/" class="external-link">Zenodo Search
guide</a>.</p>
<p>Since the Zenodo API is paginated, an extra parameter
<code>size</code> can be specified to indicate the number of records to
be queried by page (default value is 10).</p>
<p>By default, the Zenodo API will return only the latest versions of a
record. It is possible to retrieve all versions of records by specifying
<code>all_versions = FALSE</code>.</p>
<p><a name="ZenodoDeposit-query-getdepositionbyconceptdoi"></a></p>
</div>
<div class="section level6">
<h6 id="get-deposition-by-concept-doi">4.3.2 Get Deposition By Concept DOI<a class="anchor" aria-label="anchor" href="#get-deposition-by-concept-doi"></a>
</h6>
<p>It is possible to interrogate and get a Zenodo record with its
concept DOI (generic DOI common to all versions of a record):</p>
<pre><code><span><span class="va">my_rec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getDepositionByConceptDOI</span><span class="op">(</span><span class="st">"&lt;my_concept_doi&gt;"</span><span class="op">)</span></span></code></pre>
<p><a name="ZenodoDeposit-query-getdepositionbydoi"></a></p>
</div>
<div class="section level6">
<h6 id="get-deposition-by-doi">4.3.3 Get Deposition By DOI<a class="anchor" aria-label="anchor" href="#get-deposition-by-doi"></a>
</h6>
<p>It is possible to interrogate and get a Zenodo record with its DOI
(record version-specific DOI):</p>
<pre><code><span><span class="va">my_rec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getDepositionByDOI</span><span class="op">(</span><span class="st">"&lt;my_doi&gt;"</span><span class="op">)</span></span></code></pre>
<p><a name="ZenodoDeposit-query-getdepositionbyid"></a></p>
</div>
<div class="section level6">
<h6 id="get-deposition-by-zenodo-id">4.3.4 Get Deposition By Zenodo ID<a class="anchor" aria-label="anchor" href="#get-deposition-by-zenodo-id"></a>
</h6>
<p>It is possible to interrogate and get a Zenodo record with its
internal ID:</p>
<pre><code><span><span class="va">my_rec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getDepositionById</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span></code></pre>
<p><a name="ZenodoDeposit-getversions"></a></p>
</div>
<div class="section level6">
<h6 id="get-versions-of-a-zenodo-record">4.3.4 Get versions of a Zenodo record<a class="anchor" aria-label="anchor" href="#get-versions-of-a-zenodo-record"></a>
</h6>
<p>For a given record, it’s possible to get the list of versions of this
record:</p>
<pre><code><span><span class="va">my_rec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getDepositionByConceptDOI</span><span class="op">(</span><span class="st">"&lt;some_concept_doi&gt;"</span><span class="op">)</span></span>
<span><span class="va">my_rec</span><span class="op">$</span><span class="fu">getVersions</span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>The list of versions is provided as <code>data.frame</code> given the
date of publication, version number, and DOI of each version.</p>
<blockquote>
<p>Note: This function is not provided through the Zenodo API, but
exploits to Zenodo website and has been added to <a href="https://doi.org/10.5281/zenodo.2547036" class="external-link">zen4R</a> to facilitate
the browsing of record versions.</p>
</blockquote>
<p><a name="ZenodoDeposit"></a></p>
</div>
</div>
<div class="section level5">
<h5 id="manage-zenodo-record-depositions">4.4 Manage Zenodo record depositions<a class="anchor" aria-label="anchor" href="#manage-zenodo-record-depositions"></a>
</h5>
<p><a name="ZenodoDeposit-emptyRecord"></a></p>
<div class="section level6">
<h6 id="create-an-empty-record">4.4.1 Create an empty record<a class="anchor" aria-label="anchor" href="#create-an-empty-record"></a>
</h6>
<p>It is possible to create and deposit an empty record, ready for
editing. For that, run the following R code:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myrec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">createEmptyRecord</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This method will return an object of class <code>ZenodoRecord</code>
for which an internal <code>id</code> and a DOI have been pre-defined by
Zenodo. An alternate method is to create a local empty record (not
deposited on Zenodo) doing:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myrec</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ZenodoRecord.html">ZenodoRecord</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The next section explains how to fill the record with metadata
elements.</p>
<p><a name="ZenodoDeposit-fill"></a></p>
</div>
<div class="section level6">
<h6 id="fill-a-record">4.4.2 Fill a record<a class="anchor" aria-label="anchor" href="#fill-a-record"></a>
</h6>
<p>Zenodo records can be described a set of multiple metadata elements.
For a full documentation of these metadata elements, please consult the
zen4R documentation with <code><a href="../reference/ZenodoRecord.html">?ZenodoRecord</a></code>. The online Zenodo
API documentation can be consulted as well <a href="https://developers.zenodo.org/#representation" class="external-link">here</a>.</p>
<p>Example of record filling with metadata elements:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myrec</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/ZenodoRecord.html">ZenodoRecord</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">setTitle</span><span class="op">(</span><span class="st">"zen4R"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addAdditionalTitle</span><span class="op">(</span><span class="st">"This is an alternative title"</span>, type <span class="op">=</span> <span class="st">"alternative-title"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">setDescription</span><span class="op">(</span><span class="st">"Interface to 'Zenodo' REST API"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addAdditionalDescription</span><span class="op">(</span><span class="st">"This is an abstract"</span>, type <span class="op">=</span> <span class="st">"abstract"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">setPublicationDate</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">setResourceType</span><span class="op">(</span><span class="st">"software"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addCreator</span><span class="op">(</span>firstname <span class="op">=</span> <span class="st">"Emmanuel"</span>, lastname <span class="op">=</span> <span class="st">"Blondel"</span>, role <span class="op">=</span> <span class="st">"datamanager"</span>, orcid <span class="op">=</span> <span class="st">"0000-0002-5870-5762"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addContributor</span><span class="op">(</span>firstname <span class="op">=</span> <span class="st">"Peter"</span>, lastname <span class="op">=</span> <span class="st">"Lead"</span>, role <span class="op">=</span> <span class="st">"workpackageleader"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addContributor</span><span class="op">(</span>firstname <span class="op">=</span> <span class="st">"Frank"</span>, <span class="st">"Super"</span>, role <span class="op">=</span> <span class="st">"supervisor"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">setLicense</span><span class="op">(</span><span class="st">"mit"</span>, sandbox <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">setKeywords</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R"</span>,<span class="st">"package"</span>,<span class="st">"software"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addReference</span><span class="op">(</span><span class="st">"Author et al., 2019. Title"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addReference</span><span class="op">(</span><span class="st">"Fulano et al., 2018. Título"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">setPublisher</span><span class="op">(</span><span class="st">"CRAN"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">setVersion</span><span class="op">(</span><span class="st">"0.10"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addGrant</span><span class="op">(</span><span class="st">"00k4n6c32::862409"</span>, sandbox <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addRelatedIdentifier</span><span class="op">(</span><span class="st">"https://github.com/eblondel/zen4R/wiki#41-how-to-install-zen4r-in-r"</span>, scheme <span class="op">=</span> <span class="st">"url"</span>, relation_type <span class="op">=</span> <span class="st">"haspart"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addRelatedIdentifier</span><span class="op">(</span><span class="st">"https://github.com/eblondel/zen4R/wiki#42-connect-to-zenodo-rest-api"</span>, scheme <span class="op">=</span> <span class="st">"url"</span>, relation_type <span class="op">=</span> <span class="st">"haspart"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addRelatedIdentifier</span><span class="op">(</span><span class="st">"https://github.com/eblondel/zen4R/wiki#43-query-zenodo-deposited-records"</span>, scheme <span class="op">=</span> <span class="st">"url"</span>, relation_type <span class="op">=</span> <span class="st">"haspart"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addRelatedIdentifier</span><span class="op">(</span><span class="st">"https://github.com/eblondel/zen4R/wiki#44-manage-zenodo-record-depositions"</span>, scheme <span class="op">=</span> <span class="st">"url"</span>, relation_type <span class="op">=</span> <span class="st">"haspart"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addRelatedIdentifier</span><span class="op">(</span><span class="st">"https://github.com/eblondel/zen4R/wiki#45-manage-zenodo-record-deposition-files"</span>, scheme <span class="op">=</span> <span class="st">"url"</span>, relation_type <span class="op">=</span> <span class="st">"haspart"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addRelatedIdentifier</span><span class="op">(</span><span class="st">"https://github.com/eblondel/zen4R/wiki#46-export-zenodo-record-metadata"</span>, scheme <span class="op">=</span> <span class="st">"url"</span>, relation_type <span class="op">=</span> <span class="st">"haspart"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addRelatedIdentifier</span><span class="op">(</span><span class="st">"https://github.com/eblondel/zen4R/wiki#47-browse-zenodo-controlled-vocabularies"</span>, scheme <span class="op">=</span> <span class="st">"url"</span>, relation_type <span class="op">=</span> <span class="st">"haspart"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addRelatedIdentifier</span><span class="op">(</span><span class="st">"https://github.com/eblondel/zen4R/wiki#48-query-zenodo-published-records"</span>, scheme <span class="op">=</span> <span class="st">"url"</span>, relation_type <span class="op">=</span> <span class="st">"haspart"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addRelatedIdentifier</span><span class="op">(</span><span class="st">"https://github.com/eblondel/zen4R/wiki#49-download-files-from-zenodo-records"</span>, scheme <span class="op">=</span> <span class="st">"url"</span>, relation_type <span class="op">=</span> <span class="st">"haspart"</span><span class="op">)</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">addRelatedIdentifier</span><span class="op">(</span><span class="st">"https://github.com/eblondel/zen4R/wiki#user_guide"</span>, scheme <span class="op">=</span> <span class="st">"url"</span>, <span class="st">"ispartof"</span>, <span class="st">"publication-book"</span><span class="op">)</span></span></code></pre></div>
<p><a name="ZenodoDeposit-deposit"></a></p>
</div>
<div class="section level6">
<h6 id="depositupdate-a-record">4.4.3 Deposit/update a record<a class="anchor" aria-label="anchor" href="#depositupdate-a-record"></a>
</h6>
<p>Once the record is edited/updated, you can deposit it on Zenodo with
the following code:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myrec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">depositRecord</span><span class="op">(</span><span class="va">myrec</span><span class="op">)</span></span></code></pre></div>
<p>In order to apply further methods on this record (e.g. upload a file,
publish/delete a record), you need to get the output of the function
<code>depositRecord</code> (see example above) since after the
deposition Zenodo will return the record that now contains an internal
<code>id</code> required to identify and apply further actions. This id
can be inspected with <code>myrec$id</code>.</p>
<p>Instead, if you don’t get the output of <code>depositRecord</code>
and try to upload files or publish/delete the record based on the local
record you handle (built upon <code>ZenodoRecord$new()</code>), this
will not work. Because it is a local record, the <code>id</code> of the
record will still be <code>NULL</code>, with no value assigned by
Zenodo, and Zenodo will be unable to identify which record needs to be
handled.</p>
<p><a name="ZenodoDeposit-delete"></a></p>
</div>
<div class="section level6">
<h6 id="delete-a-record">4.4.4 Delete a record<a class="anchor" aria-label="anchor" href="#delete-a-record"></a>
</h6>
<p>A record deposited on Zenodo but not yet published remains in the <a href="https://zenodo.org/deposit" class="external-link">Upload</a> area of Zenodo (a kind of
staging area where draft records are in edition). As long as it is not
published, a record can be deleted from the Zenodo <a href="https://zenodo.org/deposit" class="external-link">Upload</a> area using:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zenodo</span><span class="op">$</span><span class="fu">deleteRecord</span><span class="op">(</span><span class="va">myrec</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p><a name="ZenodoDeposit-publish"></a></p>
</div>
<div class="section level6">
<h6 id="publish-a-record">4.4.5 Publish a record<a class="anchor" aria-label="anchor" href="#publish-a-record"></a>
</h6>
<p>To publish a deposited record and make it available publicly online
on Zenodo, the following method can be run:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myrec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">publishRecord</span><span class="op">(</span><span class="va">myrec</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p>A shortcut to publish a record is also available through the method
<code>depositRecord</code>, specifying <code>publish = TRUE</code>. This
method should be used with cautious giving the fact the record will go
straight online on Zenodo if published. By default the parameter
<code>publish</code> will be set to <code>FALSE</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myrec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">depositRecord</span><span class="op">(</span><span class="va">myrec</span>, publish <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The publication of a record requires at least to have uploaded at
least one file for this record. See section <a href="https://github.com/eblondel/zen4R/wiki#44-manage-zenodo-record-deposition-files" class="external-link">4.4.1
Upload file</a>.</p>
<p><a name="ZenodoDeposit-edit"></a></p>
</div>
<div class="section level6">
<h6 id="editupdate-a-published-record">4.4.6 Edit/Update a published record<a class="anchor" aria-label="anchor" href="#editupdate-a-published-record"></a>
</h6>
<p>It is possible to update metadata of a published record, but not to
modify the files associated to it. In order to update metadata of a
published record, the <code>state</code> of this record has to be
modified to make it editable. For that, use the <code>editRecord</code>
function giving the <code>id</code> of the record to edit:</p>
<pre><code><span><span class="va">myrec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">editRecord</span><span class="op">(</span><span class="va">myrec</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span></code></pre>
<p>Next, perform your metadata updates, and re-deposit the record</p>
<pre><code><span><span class="va">myrec</span><span class="op">$</span><span class="fu">setTitle</span><span class="op">(</span><span class="st">"newtitle"</span><span class="op">)</span></span>
<span><span class="va">myrec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">depositRecord</span><span class="op">(</span><span class="va">myrec</span>, publish <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
<p>Since the record has been switched back to <code>draft</code> state,
the record has to be re-published otherwise it will remain a draft
record in your Zenodo user session.</p>
<p><a name="ZenodoDeposit-discard"></a></p>
</div>
<div class="section level6">
<h6 id="discard-changes-of-a-draft-record">4.4.7 Discard changes of a draft record<a class="anchor" aria-label="anchor" href="#discard-changes-of-a-draft-record"></a>
</h6>
<p>In case you started editing a record and you want to discard changes
on it, it is possible to do it with the <code>discardChanges</code>.</p>
<pre><code><span><span class="va">zenodo</span><span class="op">$</span><span class="fu">discardChanges</span><span class="op">(</span><span class="va">myrec</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span></code></pre>
<p><a name="ZenodoDeposit-version"></a></p>
</div>
<div class="section level6">
<h6 id="create-a-new-version-record">4.4.8 Create a new version record<a class="anchor" aria-label="anchor" href="#create-a-new-version-record"></a>
</h6>
<p>To create a new record version, you should first retrieve the record
for which you want to create a new version. You can retrieve this record
with methods based on DOI such as <code>getDepositionByConceptDOI</code>
(to get a record based on concept DOI) or
<code>getDepositionByDOI</code>; or by Zenodo <code>id</code> with
<code>getDepositionById</code> :</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#get record by DOI</span></span>
<span><span class="va">myrec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getDepositionByDOI</span><span class="op">(</span><span class="st">"&lt;some doi&gt;"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#edit myrec with updated metadata for the new version</span></span>
<span><span class="co">#...</span></span>
<span></span>
<span><span class="co">#create new version</span></span>
<span><span class="va">myrec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">depositRecordVersion</span><span class="op">(</span><span class="va">myrec</span>, delete_latest_files <span class="op">=</span> <span class="cn">TRUE</span>, files <span class="op">=</span> <span class="st">"newversion.csv"</span>, publish <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>The function <code>depositRecordVersion</code> will create a new
version for the published record. The parameter
<code>delete_latest_files</code> (default = <code>TRUE</code>) allows to
delete latest files (knowing that a new record version expect to have
different file(s) than the latest version). The <code>files</code>
parameter allows to list the files to be uploaded. As for the
<code>depositRecord</code>, it is possible to publish the record with
the <code>publish</code> paramater.</p>
<p><a name="ZenodoDepositFile"></a></p>
</div>
</div>
<div class="section level5">
<h5 id="manage-zenodo-record-deposition-files">4.5 Manage Zenodo record deposition files<a class="anchor" aria-label="anchor" href="#manage-zenodo-record-deposition-files"></a>
</h5>
<p><a name="ZenodoDepositFile-upload"></a></p>
<div class="section level6">
<h6 id="upload-file">4.5.1 Upload file<a class="anchor" aria-label="anchor" href="#upload-file"></a>
</h6>
<p>With <code>zen4R</code>, it is very easy to upload a file to a record
deposition. The record should first deposited on Zenodo. To upload a
file, the following single line can be used, where the file
<code>path</code> is specified and the record deposit to which the file
should be uploaded:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zenodo</span><span class="op">$</span><span class="fu">uploadFile</span><span class="op">(</span><span class="st">"path/to/your/file"</span>, record <span class="op">=</span> <span class="va">myrec</span><span class="op">)</span></span></code></pre></div>
<p><a name="ZenodoDepositFile-get"></a></p>
</div>
<div class="section level6">
<h6 id="get-files">4.5.2 Get files<a class="anchor" aria-label="anchor" href="#get-files"></a>
</h6>
<p>To get the list of files attached to a record, you can specify the
following method adding the record <code>id</code>:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zen_files</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getFiles</span><span class="op">(</span><span class="va">myrec</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p>This retrieves a list of files. Each file has a unique
<code>id</code>, that can be used to for file deletion.</p>
<p><a name="ZenodoDepositFile-delete"></a></p>
</div>
<div class="section level6">
<h6 id="delete-file">4.5.3 Delete file<a class="anchor" aria-label="anchor" href="#delete-file"></a>
</h6>
<p>The following example shows how to delete the first file attached to
the record defined earlier. To delete a file, we need to specify both
the record and file identifiers:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zenodo</span><span class="op">$</span><span class="fu">deleteFile</span><span class="op">(</span><span class="va">myrec</span><span class="op">$</span><span class="va">id</span>, <span class="va">zen_files</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p><a name="ZenodoDeposit-communities"></a></p>
</div>
</div>
<div class="section level5">
<h5 id="manage-zenodo-record-deposition-files-1">4.6 Manage Zenodo record deposition files<a class="anchor" aria-label="anchor" href="#manage-zenodo-record-deposition-files-1"></a>
</h5>
<p>With the move to Invenio, the addition of a record to a community is
not anymore managed as part of the metadata. The way to manage
communities will differ depending on the status of the record you want
to add to a community.</p>
<p><a name="ZenodoDeposit-communities-published"></a></p>
<div class="section level6">
<h6 id="submit-a-published-record-to-communities">4.6.1 Submit a published record to communities<a class="anchor" aria-label="anchor" href="#submit-a-published-record-to-communities"></a>
</h6>
<p>For a record already published (with a DOI), it is very
straighforward to submit it to communities (whether or not you are the
manager of these communities). To do so, run the following code over
your <code>record</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">communities</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"openfair"</span>, <span class="st">"test"</span><span class="op">)</span></span>
<span><span class="va">zenodo</span><span class="op">$</span><span class="fu">submitRecordToCommunities</span><span class="op">(</span><span class="va">record</span>, <span class="va">communities</span><span class="op">)</span></span></code></pre></div>
<p>In case a community name doesn’t match an existing community, some
warning wil be raised without any blocking error.</p>
<p>As submitter of a record to a community, you have privileges to
<em>cancel</em> this request. As manager of a community, you have
privileges either to <em>accept</em> or <em>decline</em> a request to
add a record to a community. If you want to learn about requests
management, please see section 4.11.</p>
<p><a name="ZenodoDeposit-communities-draft"></a></p>
</div>
<div class="section level6">
<h6 id="submit-a-draft-record-to-a-community">4.6.2 Submit a draft record to a community<a class="anchor" aria-label="anchor" href="#submit-a-draft-record-to-a-community"></a>
</h6>
<p>Adding a draft record to a community is possible with the new Zenodo
platform. This method is ‘kind of’ analog of what was possible with the
legacy Zenodo and zen4R version &lt; 0.10. Before, the addition of a
draft record to a community was part of the metadata elements. With the
new Zenodo, thi action is done with 2 different methods:</p>
<ul>
<li>a first method that will “attach” the record the community:</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_community</span> <span class="op">=</span> <span class="st">"openfair"</span></span>
<span><span class="va">ZENODO</span><span class="op">$</span><span class="fu">createReviewRequest</span><span class="op">(</span><span class="va">record</span>, <span class="va">my_community</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>a second method that allows to <em>submit</em> the record for review
by this community manager:</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ZENODO</span><span class="op">$</span><span class="fu">submitRecordForReview</span><span class="op">(</span><span class="va">record</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
<p>Indeed, adding a draft deposit/record to a community means now that
you are requesting a record to be <em>reviewed</em> for publication in a
community. The latter <code>submitRecordForReview</code> adds a review
step before the record publication. This is materialized by a request
for addition to the community (as above), but with a review to be
performed by the manager. This action has several implications:</p>
<ul>
<li>you can’t anymore publish by yourself the record, this is delegated
to the community manager.</li>
<li>the community manager has editing rights over your draft
deposit</li>
</ul>
<p>Note that:</p>
<ul>
<li>you can create a review request to <em>only one community</em>
</li>
<li>in case you want to cancel the review, you have to search for the
community requests (see section 4.11), and cancel you request. After
this only, you will be able to delete the community attachment by
doing:</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ZENODO</span><span class="op">$</span><span class="fu">deleteReviewRequest</span><span class="op">(</span><span class="va">record</span><span class="op">)</span></span></code></pre></div>
<p><a name="ZenodoDepositMetadata"></a></p>
</div>
</div>
<div class="section level5">
<h5 id="export-zenodo-record-metadata">4.7 Export Zenodo record metadata<a class="anchor" aria-label="anchor" href="#export-zenodo-record-metadata"></a>
</h5>
<p>For a given Zenodo record, <a href="https://doi.org/10.5281/zenodo.2547036" class="external-link">zen4R</a> let you export
the metadata in a metadata file, with a series of <code>exportAs*</code>
methods.</p>
<p>The metadata formats supported are: <code>BibTeX</code>,
<code>CSL</code>, <code>DataCite</code>, <code>DublinCore</code>,
<code>DCAT</code>, <code>JSON</code>, <code>JSON-LD</code>,
<code>GeoJSON</code>, <code>MARCXML</code></p>
<p><a name="ZenodoDepositMetadata-byformat"></a></p>
<div class="section level6">
<h6 id="export-zenodo-record-metadata-by-format">4.7.1 Export Zenodo record metadata by format<a class="anchor" aria-label="anchor" href="#export-zenodo-record-metadata-by-format"></a>
</h6>
<p>To export a record in a given format, they are two ways:</p>
<pre><code><span><span class="co">#using the generic exportAs</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">exportAs</span><span class="op">(</span><span class="st">"BibTeX"</span>, filename <span class="op">=</span> <span class="st">"myfilename"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#using the format-specific wrapper</span></span>
<span><span class="va">myrec</span><span class="op">$</span><span class="fu">exportAsBibTeX</span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"myfilename"</span><span class="op">)</span></span></code></pre>
<p>The <code>filename</code> provided should not include the file
extension that is managed by zen4R, depending on the chosen format.</p>
<p><a name="ZenodoDepositMetadata-allformats"></a></p>
</div>
<div class="section level6">
<h6 id="export-zenodo-record-metadata---all-formats">4.7.2 Export Zenodo record metadata - all formats<a class="anchor" aria-label="anchor" href="#export-zenodo-record-metadata---all-formats"></a>
</h6>
<p>To export a record in all above metadata formats:</p>
<pre><code><span><span class="va">myrec</span><span class="op">$</span><span class="fu">exportAsAllFormats</span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"myfilename"</span><span class="op">)</span></span></code></pre>
<p>The <code>filename</code> provided should not include the file
extension that is managed by zen4R, depending on the format.</p>
<p><a name="ZenodoVocabularies"></a></p>
</div>
</div>
<div class="section level5">
<h5 id="browse-zenodo-controlled-vocabularies">4.8 Browse Zenodo controlled vocabularies<a class="anchor" aria-label="anchor" href="#browse-zenodo-controlled-vocabularies"></a>
</h5>
<p><a name="ZenodoVocabularies-communities"></a></p>
<div class="section level6">
<h6 id="communities">4.8.1 Communities<a class="anchor" aria-label="anchor" href="#communities"></a>
</h6>
<pre><code><span><span class="va">communities</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getCommunities</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">com</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getCommunity</span><span class="op">(</span><span class="st">"openfair"</span><span class="op">)</span></span></code></pre>
<p><a name="ZenodoVocabularies-licenses"></a></p>
</div>
<div class="section level6">
<h6 id="licenses">4.8.2 Licenses<a class="anchor" aria-label="anchor" href="#licenses"></a>
</h6>
<pre><code><span><span class="va">licenses</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getLicenses</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">lic</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getLicenseById</span><span class="op">(</span><span class="st">"mit"</span><span class="op">)</span></span></code></pre>
<p><a name="ZenodoVocabularies-funders"></a></p>
</div>
<div class="section level6">
<h6 id="funders">4.8.3 Funders<a class="anchor" aria-label="anchor" href="#funders"></a>
</h6>
<pre><code><span><span class="va">funders</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getFunders</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">some_funders</span> <span class="op">&lt;-</span> <span class="va">ZENODO</span><span class="op">$</span><span class="fu">getFundersByName</span><span class="op">(</span><span class="st">"EU"</span><span class="op">)</span></span>
<span><span class="va">some_funder</span> <span class="op">&lt;-</span><span class="va">ZENODO</span><span class="op">$</span><span class="fu">getFunderById</span><span class="op">(</span><span class="st">"04facnr46"</span><span class="op">)</span></span></code></pre>
<p><a name="ZenodoVocabularies-grants"></a></p>
</div>
<div class="section level6">
<h6 id="grants-awards">4.8.4 Grants / Awards<a class="anchor" aria-label="anchor" href="#grants-awards"></a>
</h6>
<p>With the move to Invenio, grants are generally referred to awards.
For backward-compatibility, methods referring to “grants” are still
supported with warning.</p>
<pre><code><span><span class="va">grants</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getAwards</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">some_grant</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getAwardById</span><span class="op">(</span><span class="st">"00k4n6c32::862409"</span><span class="op">)</span></span></code></pre>
<p><a name="ZenodoRecord-query"></a></p>
</div>
</div>
<div class="section level5">
<h5 id="query-zenodo-published-records">4.9 Query Zenodo published records<a class="anchor" aria-label="anchor" href="#query-zenodo-published-records"></a>
</h5>
<p><a href="https://doi.org/10.5281/zenodo.2547036" class="external-link">zen4R</a> offers
several methods to query Zenodo records.</p>
<p><a name="ZenodoRecord-getrecords"></a></p>
<div class="section level6">
<h6 id="get-records">4.9.1 Get Records<a class="anchor" aria-label="anchor" href="#get-records"></a>
</h6>
<p>The generic way to query records is to use the method
<code>getRecords</code></p>
<pre><code><span><span class="va">my_zenodo_records</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getRecords</span><span class="op">(</span>q <span class="op">=</span> <span class="st">"&lt;my_elastic_search_query&gt;"</span><span class="op">)</span></span></code></pre>
<p>The <code>q</code> parameter should be an ElasticSearch query. For
helpers and query examples, please consult this <a href="https://help.zenodo.org/guides/search/" class="external-link">Zenodo Search
guide</a>.</p>
<p>Since the Zenodo API is paginated, an extra parameter
<code>size</code> can be specified to indicate the number of records to
be queried by page (default value is 10).</p>
<p>By default, the Zenodo API will return only the latest versions of a
record. It is possible to retrieve all versions of records by specifying
<code>all_versions = FALSE</code>.</p>
<p><a name="ZenodoRecord-getrecordbyconceptdoi"></a></p>
</div>
<div class="section level6">
<h6 id="get-record-by-concept-doi">4.9.2 Get Record By Concept DOI<a class="anchor" aria-label="anchor" href="#get-record-by-concept-doi"></a>
</h6>
<p>It is possible to interrogate and get a Zenodo record with its
concept DOI (generic DOI common to all versions of a record):</p>
<pre><code><span><span class="va">my_rec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getRecordByConceptDOI</span><span class="op">(</span><span class="st">"&lt;my_concept_doi&gt;"</span><span class="op">)</span></span></code></pre>
<p><a name="ZenodoRecord-getrecordbydoi"></a></p>
</div>
<div class="section level6">
<h6 id="get-record-by-doi">4.9.3 Get Record By DOI<a class="anchor" aria-label="anchor" href="#get-record-by-doi"></a>
</h6>
<p>It is possible to interrogate and get a Zenodo record with its DOI
(record version-specific DOI):</p>
<pre><code><span><span class="va">my_rec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getRecordByDOI</span><span class="op">(</span><span class="st">"&lt;my_doi&gt;"</span><span class="op">)</span></span></code></pre>
<p><a name="ZenodoRecord-getrecordbyid"></a></p>
</div>
<div class="section level6">
<h6 id="get-record-by-zenodo-id">4.9.4 Get Record By Zenodo ID<a class="anchor" aria-label="anchor" href="#get-record-by-zenodo-id"></a>
</h6>
<p>It is possible to interrogate and get a Zenodo record with its
internal ID:</p>
<pre><code><span><span class="va">my_rec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getRecordById</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span></code></pre>
<p><a name="ZenodoRecord-download"></a></p>
</div>
</div>
<div class="section level5">
<h5 id="download-files-from-zenodo-records">4.10 Download files from Zenodo records<a class="anchor" aria-label="anchor" href="#download-files-from-zenodo-records"></a>
</h5>
<p><a href="https://doi.org/10.5281/zenodo.2547036" class="external-link">zen4R</a> offers
methods to download files Zenodo published records.</p>
<p>Being published records, the latter and their files are accessible
without any user token using
<code>zenodo &lt;- ZenodoManager$new(logger = "INFO")</code>. Files can
be then downloaded either from a Zenodo <code>record</code> object
(fetched with <code>getRecordByDOI</code>):</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">rec</span> <span class="op">&lt;-</span> <span class="va">zenodo</span><span class="op">$</span><span class="fu">getRecordByDOI</span><span class="op">(</span><span class="st">"10.5281/zenodo.3378733"</span><span class="op">)</span></span>
<span>  <span class="va">files</span> <span class="op">&lt;-</span> <span class="va">rec</span><span class="op">$</span><span class="fu">listFiles</span><span class="op">(</span>pretty <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#create a folder where to download my files</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"download_zenodo"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#download files</span></span>
<span>  <span class="va">rec</span><span class="op">$</span><span class="fu">downloadFiles</span><span class="op">(</span>path <span class="op">=</span> <span class="st">"download_zenodo"</span><span class="op">)</span></span>
<span>  <span class="va">downloaded_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"download_zenodo"</span><span class="op">)</span></span></code></pre></div>
<p>or using the shortcut function <code>download_zenodo</code>:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#create a folder where to download my files</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="st">"download_zenodo"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">#download files with shortcut function 'download_zenodo'</span></span>
<span>  <span class="fu"><a href="../reference/download_zenodo.html">download_zenodo</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"download_zenodo"</span>, <span class="st">"10.5281/zenodo.3378733"</span><span class="op">)</span></span>
<span>  <span class="va">downloaded_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"download_zenodo"</span><span class="op">)</span></span></code></pre></div>
<p>Download can be also be done in parallel with <code>parallel</code>
package, depending on the plateform. See below examples:</p>
<ul>
<li>For both Unix/Win OS (using clusters)</li>
</ul>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span>  <span class="co">#download files as parallel using a cluster approach (for both Unix/Win systems)</span></span>
<span>  <span class="fu"><a href="../reference/download_zenodo.html">download_zenodo</a></span><span class="op">(</span><span class="st">"10.5281/zenodo.2547036"</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, parallel_handler <span class="op">=</span> <span class="va">parLapply</span>, cl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>For Unix OS (using <code>mclapply</code>)</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">#download files as parallel using mclapply (for Unix systems)</span></span>
<span>  <span class="fu"><a href="../reference/download_zenodo.html">download_zenodo</a></span><span class="op">(</span><span class="st">"10.5281/zenodo.2547036"</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, parallel_handler <span class="op">=</span> <span class="va">mclapply</span>, mc.cores <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><a name="Zenodo-requests"></a></p>
</div>
<div class="section level5">
<h5 id="manage-requests">4.11 Manage requests<a class="anchor" aria-label="anchor" href="#manage-requests"></a>
</h5>
<p>In Zenodo, requests refer essentially to requests made to add records
to a community. Depending on your privileges, you will be able to
perform different kind of operations over requests:</p>
<ul>
<li>as submitter of a record to a community, you will be able to list
the requests you made and <em>cancel</em> (eventually) a request</li>
<li>as manager of a community, you will be able to see your requests but
also requests made by users to add records to your community, in which
case you will be able to <em>accept</em> or <em>decline</em> a
request.</li>
</ul>
<p>The operations on requests (<code>cancel</code>, <code>accept</code>,
<code>decline</code>) require to get the request ID. To get such ID, you
first need to search over requests.</p>
<ol style="list-style-type: decimal">
<li>Let’s suppose that as user, you submitted one of your record to a
community. You wish to cancel this request. You can search over the
request that is in ‘submitted’ status for this particular community
targeting your record:</li>
</ol>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>zen_com <span class="ot">=</span> zenodo<span class="sc">$</span><span class="fu">getCommunityById</span>(<span class="st">"openfair)</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a><span class="st">reqs = zenodo$getRequests(q = sprintf("</span>status<span class="sc">:</span>submitted AND receiver.community<span class="sc">:%s AND topic.record:%</span>s<span class="st">", zen_com$id, record$id))</span></span></code></pre></div>
<p>The above query returned only one request, that you can now
cancel:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zenodo</span><span class="op">$</span><span class="fu">cancelRequest</span><span class="op">(</span><span class="va">reqs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">id</span><span class="op">)</span> <span class="co">#return TRUE if canceled</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Let’s suppose that as manager, you want to manage incoming requests
from users to add their records to your community. You can search over
the requests:</li>
</ol>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a>zen_com <span class="ot">=</span> zenodo<span class="sc">$</span><span class="fu">getCommunityById</span>(<span class="st">"openfair)</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="st">reqs = zenodo$getRequests(q = sprintf("</span>status<span class="sc">:</span>submitted AND receiver.community<span class="sc">:</span>%s<span class="st">", zen_com$id))</span></span></code></pre></div>
<p>and then decided whether you want to <em>accept</em> or
<em>decline</em> the requests. The code below assumes we got 2 requests,
let’s accept the first, and decline the second:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ZENODO</span><span class="op">$</span><span class="fu">acceptRequest</span><span class="op">(</span><span class="va">reqs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">id</span>, message <span class="op">=</span> <span class="st">"Thank you for your request, your record has been added to 'openfair' community"</span><span class="op">)</span></span>
<span><span class="va">ZENODO</span><span class="op">$</span><span class="fu">deleteRequest</span><span class="op">(</span><span class="va">reqs</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">id</span>, message <span class="op">=</span> <span class="st">"Unfortunately your record doesn't fulfill our community standards"</span><span class="op">)</span></span></code></pre></div>
<p>In the case of a request to community made on a draft record (see
section 4.6.2), if the community manager accepts the request, the record
will be published. If the request is <em>declined</em> , you may want to
review/edit the record and resubmit it again (see section 4.6.2 with
method <code>submitRecordForReview</code>).</p>
<p><a name="package_issues"></a></p>
</div>
</div>
<div class="section level4">
<h4 id="issue-reporting">5. Issue reporting<a class="anchor" aria-label="anchor" href="#issue-reporting"></a>
</h4>
<hr>
<p>Issues can be reported at <a href="https://github.com/eblondel/zen4R/issues" class="external-link uri">https://github.com/eblondel/zen4R/issues</a></p>
<p><a name="user_support"></a></p>
</div>
<div class="section level4">
<h4 id="user-support">6. User support<a class="anchor" aria-label="anchor" href="#user-support"></a>
</h4>
<p>Do not hesitate to ask your question at <a href="https://github.com/eblondel/zen4R/discussions" class="external-link uri">https://github.com/eblondel/zen4R/discussions</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Emmanuel Blondel.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
